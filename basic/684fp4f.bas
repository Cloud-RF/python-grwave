100 REM #######################################################################
110 REM
120 REM    Prediction of LF field strength and phase to be received at a
130 REM    fixed point based on wave hop method in Rec. ITU-R P. 684
140 REM                               by
150 REM                             N. Wakai
160 REM                                              (684FP4F.BAS)  Oct. 2005
170 REM #######################################################################
180 REM
190 REM  This program is applicable for calculating resultant field strength
200 REM  and phase of 1 & 2 hop sky-wave and the ground-wave at frequencies
210 REM  between 40 and 500 kHz over ground ranges from 100 to 4000 km.
220 REM                                       (parabolic D/E layer model)
230 REM
240 CLS
250 REM #INCLUDE "windows.bi"
260 DEFDBL A-C,E,G-H,O-Z
270 PAI=3.14159265#
280 VEL=2.99792458#*10^5
290 RTD=180/PAI :DTR=PAI/180
300 RE=6367*4/3
310 DIM F(8),D(16),FG(10),DG(19),GW(10,19),FF(8,16),PS(13),AF(8,13),FCS(15),CSX(11),RCX(11,15)
320 REM
330 CLS 3
340 PRINT
350 PRINT
360 INPUT "input radiation power in kW";P
370 INPUT "input operating frequency in kHz";FREQ
380 LAMD=VEL/FREQ/1000
390 INPUT "input latitude of transmitter in degree and its decimals with - for southern latitude";LATT
400 INPUT "input longitude of transmitter in degree and its decimals with -for western longitude";LONT
410 INPUT "input latitude of receiver in degree and its decimals with - for southern latitude";LATR
420 INPUT "input longitude of receiver in degree and its decimals with -for western longitude";LONR
430 LATT=LATT*DTR: LONT=LONT*DTR: LATR=LATR*DTR: LONR=LONR*DTR
440 REM
450 REM ground range calculation
460 GOSUB 2330 REM *GRANGE
470 PRINT
480 PRINT USING "Ground range: ####.## km";GR
490 IF GR<=4000 THEN GOTO 540
500 PRINT "Caution! Ground range exceeds the upper limit of 4000 km."
510 PRINT
520 INPUT "input y to retry";Y$
530 IF "y"=Y$ THEN GOTO 340
540 PRINT
550 INPUT "input ground condition at transmitter, 1 for sea water or                                                              2 for land or                                                                   3 for dry ground";GCT
560 INPUT "input ground condition at receiver, 1 for sea water or                                                              2 for land or                                                                   3 for dry ground";GCR
570 PRINT
580 PRINT USING "Latitude and longitude at path mid-point: ###.##  and ####.##";LATP;LONP
590 INPUT "input ground condition at mid-point, 1 for sea water or                                                              2 for land or                                                                   3 for dry ground";GCM
600 REM
610 INPUT "input solar activity epoch, 1 for minimum sunspot number or                                                 2 for medium sunspot number or                                                  3 for maximum sunspot number";YR
620 INPUT "input month, 1 for January, or 2 for February or to 12 for December";MON
630 IF MON=1 THEN SOL=-21 ELSE IF MON=2 THEN SOL=-13 ELSE IF MON=3 THEN SOL=-2 ELSE IF MON=4 THEN SOL=10 ELSE IF MON=5 THEN SOL=19 ELSE IF MON=6 THEN SOL=23
640 IF MON=7 THEN SOL=22 ELSE IF MON=8 THEN SOL=14 ELSE IF MON=9 THEN SOL=3 ELSE IF MON=10 THEN SOL=-8 ELSE IF MON=11 THEN SOL=-18 ELSE IF MON=12 THEN SOL=-23
650 REM
660 INPUT "input local time at receiver";LT
670 INPUT "input local standard time meridian longitude in degree, + for east,                                                                     - for west";LSTM
680 REM
690 REM  reflection height
700 GOSUB 2540 REM *REFH
710 REM
720 FOR K=1 TO 2
730 HOP=K
740 IF HOP=1 THEN HOPL=GR ELSE HOPL=GR/2
750 REM  ray path length, elevation and incidence angles and delay
760 PL=2*SQR(RE*RE+(RE+HR)^2-2*RE*(RE+HR)*COS(HOPL/2/RE))
770 PSI=ATN(1/TAN(HOPL/2/RE)-RE/(RE+HR)/SIN(HOPL/2/RE))
780 INC=PAI/2-HOPL/2/RE-PSI
790 FC=FREQ*COS(INC) :IF FC<5 THEN FC=5
800 DTIM=HOP*(PL-HOPL)/VEL*10^6
810 DPH=(HOP*(PL-HOPL)/LAMD-INT(HOP*(PL-HOPL)/LAMD))*360
820 IF HOP=1 THEN DPH1=DPH ELSE DPH2=DPH
830 REM
840 REM  focusing factor
850 RESTORE 3930
860 FOR M=1 TO 8:READ F(M):NEXT M
870 FOR N=1 TO 16 :READ D(N):NEXT N
880 RESTORE 3950
890 FOR M=1 TO 8
900 FOR N=1 TO 16
910 READ FF(M,N)
920 NEXT N
930 NEXT M
940 GOSUB 2960 REM *INTFF
950 REM
960 REM  transmitting antenna factor
970 PSI=PSI*RTD
980 RESTORE 4040
990 FOR M=1 TO 13
1000 READ PS(M)
1010 NEXT M
1020 IF GCT=1 THEN GOTO 1030 ELSE IF GCT=2 THEN GOTO 1040 ELSE GOTO 1050
1030 RESTORE 4050 :GOTO 1060
1040 RESTORE 4140 :GOTO 1060
1050 RESTORE 4230 :GOTO 1060
1060 FOR M=1 TO 8
1070 FOR N=1 TO 13
1080 READ AF(M,N)
1090 NEXT N
1100 NEXT M
1110 GOSUB 3280 REM *INTAF
1120 FT=ANT
1130 REM
1140 REM  receiving antenna factor
1150 IF GCR=1 THEN GOTO 1160 ELSE IF GCR=2 THEN GOTO 1170 ELSE GOTO 1180
1160 RESTORE 4050 :GOTO 1190
1170 RESTORE 4140 :GOTO 1190
1180 RESTORE 4230 :GOTO 1190
1190 FOR M=1 TO 8
1200 FOR N=1 TO 13
1210 READ AF(M,N)
1220 NEXT N
1230 NEXT M
1240 GOSUB 3280 REM *INTAF
1250 FR=ANT
1260 REM
1270 REM ionospheric reflection coefficient
1280 RESTORE 4310
1290 FOR M=1 TO 11
1300 READ CSX(M)
1310 NEXT M
1320 RESTORE 4320
1330 FOR N=1 TO 15
1340 READ FCS(N)
1350 NEXT N
1360 IF YR=1 THEN GOTO 1370 ELSE IF YR=2 THEN GOTO 1380 ELSE IF YR=3 THEN GOTO 1390
1370 RESTORE 4340 :GOTO 1400
1380 RESTORE 4460 :GOTO 1400
1390 RESTORE 4580 :GOTO 1400
1400 FOR M=1 TO 11
1410 FOR N=1 TO 15
1420 READ RCX(M,N)
1430 NEXT N
1440 NEXT M
1450 GOSUB 3600 REM *INTRC
1460 REM
1470 REM  reflection coefficient of ground
1480 PSI=PSI*DTR
1490 IF PSI<.02 THEN GOTO 1660
1500 IF HOP=1 THEN GOTO 1680
1510 IF GCM=1 THEN EPS=80 ELSE IF GCM=2 THEN EPS=15 ELSE IF GCM=3 THEN EPS=15
1520 IF GCM=1 THEN SIGMA=5 ELSE IF GCM=2 THEN SIGMA=.002 ELSE IF GCM=3 THEN SIGMA=.0005
1530 X=18000*SIGMA/FREQ*1000 :ROH=SQR((EPS-COS(PSI)^2)^2+X*X)
1540 A=-ATN(X/(EPS-COS(PSI)^2)) :B=X/SQR(EPS^2+X^2)
1550 RG=SQR(ROH^2+(EPS^2+X*X)^2*SIN(PSI)^4-2*ROH*(EPS^2+X^2)*SIN(PSI)^2*COS(A+2*ATN(B/SQR(1-B*B))))/(ROH+(EPS^2+X*X)*SIN(PSI)^2+2*SQR(ROH)*SQR(EPS^2+X*X)*SIN(PSI)*COS(A/2+ATN(B/SQR(1-B*B))))
1560 IF (EPS^2+X*X)*SIN(PSI)^2-ROH=0 AND SIN(PSI)*SIN(ATN(X/EPS)+A/2)=0 THEN PHAS=0 ELSE GOTO 1580
1570 GOTO 1650
1580 IF (EPS^2+X*X)*SIN(PSI)^2-ROH=0 AND SIN(PSI)*SIN(ATN(X/EPS)+A/2)>0 THEN PHAS=PAI/2 ELSE GOTO 1600
1590 GOTO 1650
1600 IF (EPS^2+X*X)*SIN(PSI)^2-ROH=0 AND SIN(PSI)*SIN(ATN(X/EPS)+A/2)<0 THEN PHAS=-PAI/2 ELSE GOTO 1620
1610 GOTO 1650
1620 IF ROH-(EPS^2+X*X)*SIN(PSI)^2>0 THEN PHAS=-ATN(2*SQR(ROH)*SQR(EPS^2+X*X)*SIN(PSI)*SIN(ATN(X/EPS)+A/2)/(ROH-(EPS^2+X*X)*SIN(PSI)^2))+PAI ELSE GOTO 1640
1630 GOTO 1650
1640 IF ROH-(EPS^2+X*X)*SIN(PSI)^2<0 THEN PHAS=-ATN(2*SQR(ROH)*SQR(EPS^2+X*X)*SIN(PSI)*SIN(ATN(X/EPS)+A/2)/(ROH-(EPS^2+X*X)*SIN(PSI)^2))
1650 GOTO 1670
1660 RG=1 :PHAS=0
1670 REM
1680 REM  skywave field strength
1690 VU=300*SQR(P)
1700 IF HOP=2 THEN GOTO 1740
1710 EL1=2*VU/PL*COS(PSI)*RC*FOC*FT*FR
1720 FS1=20*LOG(EL1*1000)/LOG(10)
1730 GOTO 1760
1740 EL2=2*VU/PL/2*COS(PSI)*RC*RC*RG*FOC*FT*FR
1750 FS2=20*LOG(EL2*1000)/LOG(10)
1760 NEXT K
1770 REM
1780 REM  ground-wave and resultant field strength
1790 GOSUB 4710 REM *GWAVE
1800 G=10^(GWS/20)*.001
1810 REM
1820 DPH1=DPH1*DTR :DPH2=DPH2*DTR
1830 RLG=SQR(EL1^2+G^2+2*EL1*G*COS(DPH1))
1840 SINSK=EL1*SIN(DPH1)/RLG
1850 IF ABS(SINSK)>1 THEN SINSK=.99999
1860 COSSK=SQR(1-SINSK^2) :SK=ATN(SINSK/COSSK)
1870 IF SK<0 THEN SK=SK+2*PAI
1880 RL=SQR(RLG^2+EL2^2+2*RLG*EL2*COS(DPH2+PHAS-SK))
1890 SD12G=EL2*SIN(DPH2+PHAS-SK)/RL
1900 IF ABS(SD12G)>1 THEN SD12G=.99999
1910 CD12G=SQR(1-SD12G^2) :D12G=ATN(SD12G/CD12G)
1920 IF D12G<0 THEN D12G=D12G+2*PAI
1930 RLDB=20*LOG(RL*1000)/LOG(10)
1940 DPHAS=D12G+SK
1950 IF DPHAS>2*PAI THEN DPHAS=DPHAS-INT(DPHAS/2/PAI)*2*PAI
1960 REM
1970 PRINT
1980 PRINT
1990 PRINT USING " Transmitter power: ###.# kW   Frequency: ###.## kHz";P;FREQ
2000 PRINT USING " Latitude and longitude of transmitter: ###.##   ####.##";LATT*RTD;LONT*RTD
2010 PRINT USING " Latitude and longitude of receiver: ###.##   ####.##";LATR*RTD;LONR*RTD
2020 PRINT USING " Ground range: ####.## km";GR
2030 PRINT
2040 PRINT USING " Ground-wave field strength: ###.#### mV/m   ####.## dBuV/m";G;GWS
2050 PRINT USING " Resultant field strength: ###.#### mV/m  ####.## dBuV/m at ##.# h";RL;RLDB;LT
2060 PRINT USING " Phase delay of resultant relative to ground-wave: ###.## degree";DPHAS*RTD
2070 PRINT
2080 PRINT "Do you need hardcopy? (Y/N)";
2090 Q$=INKEY$ :IF Q$="" THEN GOTO 2090
2100 IF Q$="N" OR Q$="n" THEN GOTO 2230
2110 IF Q$="Y" OR Q$="y" THEN GOTO 2120
2120 LPRINT
2130 LPRINT
2140 LPRINT USING " Transmitter power: ###.# kW   Frequency: ###.## kHz";P;FREQ
2150 LPRINT USING " Latitude and longitude of transmitter: ###.##   ####.##";LATT*RTD;LONT*RTD
2160 LPRINT USING " Latitude and longitude of receiver: ###.##   ####.##";LATR*RTD;LONR*RTD
2170 LPRINT USING " Ground range: ####.## km";GR
2180 LPRINT
2190 LPRINT USING " Ground-wave field strength: ###.#### mV/m   ####.## dBuV/m";G;GWS
2200 LPRINT USING " Resultant strength: ###.#### mV/m  ####.## dBuV/m at ##.# h";RL;RLDB;LT
2210 LPRINT USING " Phase delay of resultant relative to ground-wave: ###.## degree";DPHAS*RTD
2220 LPRINT
2230 PRINT
2240 PRINT
2250 PRINT "Do you continue calculation? (Y/N)";
2260 Q$=INKEY$ :IF Q$="" THEN GOTO 2260
2270 IF Q$="N" OR Q$="n" THEN GOTO 2290
2280 IF Q$="Y" OR Q$="y" THEN GOTO 330
2290 STOP
2300 END
2310 REM
2320 REM ground range calculation
2330 REM *GRANGE
2340 DIFL=ABS(LONT-LONR)
2350 IF DIFL>PAI THEN DIFL=2*PAI-DIFL
2360 CACOS=SIN(LATT)*SIN(LATR)+COS(LATT)*COS(LATR)*COS(DIFL)
2370 CASIN=SQR(1-CACOS^2)
2380 CA=ATN(CASIN/CACOS)
2390 IF CA<0 THEN CA=CA+PAI
2400 GR=CA*6367
2410 REM
2420 REM  reflection point coordinate
2430 PCOS=COS(CA/2)*SIN(LATT)+SIN(CA/2)*COS(LATT)*(SIN(LATR)-SIN(LATT)*COS(CA))/COS(LATT)/SIN(CA)
2440 PSIN=SQR(1-PCOS^2)
2450 IF PSIN/PCOS<0 THEN LATP=-PAI/2-ATN(PSIN/PCOS) ELSE LATP=PAI/2-ATN(PSIN/PCOS)
2460 QCOS=(COS(CA/2)-SIN(LATP)*SIN(LATT))/COS(LATP)/COS(LATT)
2470 IF ABS(QCOS)>1 THEN QCOS=.999999
2480 QSIN=SQR(1-QCOS^2)
2490 IF LONT>0 AND LONT<PAI THEN LONP=LONT+ATN(QSIN/QCOS) ELSE LONP=LONT-ATN(QSIN/QCOS)
2500 LATP=LATP*RTD :LONP=LONP*RTD
2510 RETURN
2520 REM
2530 REM  reflection height subroutine
2540 REM *REFH
2550 IF YR=1 THEN SSN=13 ELSE IF YR=2 THEN SSN=50 ELSE IF YR=3 THEN SSN=100
2560 PHI=SSN+46-23*EXP(-.05*SSN)
2570 FMIN=(.004*(1+.021*PHI)^2)^.25*1000
2580 AP=1+.0094*(PHI-66)
2590 IF ABS(LATP-SOL)<80 THEN NF=LATP-SOL ELSE IF ABS(LATP-SOL)>=80 THEN NF=80
2600 IF ABS(LATP)<32 THEN MF=-1.93+1.92*COS(LATP*DTR) ELSE IF ABS(LATP)>=32 THEN MF=.11-.49*COS(LATP*DTR)
2610 BP=COS(NF*DTR)^MF
2620 IF ABS(LATP)<32 THEN XP=23 ELSE IF ABS(LATP)>=32 THEN XP=92
2630 IF ABS(LATP)<32 THEN YP=116 ELSE IF ABS(LATP)>=32 THEN YP=35
2640 CP=XP+YP*COS(LATP*DTR)
2650 IF ABS(LATP)<=12 THEN PF=1.31 ELSE IF ABS(LATP)>12 THEN PF=1.2
2660 IF LATP>0 AND SOL>0 THEN KMIN=ABS(LATP)-ABS(SOL) ELSE IF LATP<0 AND SOL<0 THEN KMIN=ABS(LATP)-ABS(SOL)
2670 KMIN=ABS(KMIN)
2680 IF LATP>0 AND SOL<0 THEN KMIN=ABS(LATP)+ABS(SOL) ELSE IF LATP<0 AND SOL>0 THEN KMIN=ABS(LATP)+ABS(SOL)
2690 IF KMIN>90 THEN KMIN=89
2700 DPM=COS(KMIN*DTR)^PF
2710 FK0=(AP*CP)^.25*1000
2720 FMAX=(AP*BP*CP*DPM)^.25*1000
2730 IF FMAX<350 THEN FMAX=350
2740 LTP=LT-(LONR*RTD-LONP)/15
2750 COSK=SIN(LATP*DTR)*SIN(SOL*DTR)+COS(LATP*DTR)*COS(SOL*DTR)*COS(PAI-15*DTR*LTP+LSTM*DTR-LONP*DTR)
2760 SINK=SQR(1-COSK^2)
2770 KAI=ATN(SINK/COSK) :IF COSK<0 THEN KAI=PAI+KAI
2780 KAI=KAI*RTD
2790 IF KAI<=73 THEN DP=COS(KAI*DTR)^PF ELSE IF KAI>73 THEN GOTO 2810
2800 GOTO 2850
2810 IF KAI>73 AND KAI<90 THEN DKAI=6.27*10^-13*(KAI-50)^8 ELSE IF KAI>=90 THEN GOTO 2840
2820 DP=COS(KAI*DTR-DKAI*DTR)^PF
2830 GOTO 2850
2840 DP=.072^PF*EXP(25.2-.28*KAI)
2850 FOE=(AP*BP*CP*DP)^.25*1000
2860 IF FOE<FMIN THEN FOE=FMIN ELSE IF FOE>=FMIN THEN FOE=FOE
2870 YMM=30-20*(FK0-FMAX)/(FK0-FMIN)
2880 YM=YMM-(YMM-10)*(FMAX-FOE)/(FMAX-FMIN)
2890 IF FOE>FREQ THEN GOTO 2900 ELSE GOTO 2920
2900 HR=100-YM*SQR(1-(FREQ-10)/FOE)
2910 GOTO 2930
2920 HR=100
2930 RETURN
2940 REM
2950 REM  focusing factor subroutine
2960 REM *INTFF
2970 FOR N=1 TO 16
2980 IF HOPL=D(N) THEN GOTO 3150
2990 NEXT N
3000 FOR N=1 TO 15
3010 IF D(N)<HOPL AND HOPL<D(N+1) THEN GOTO 3030
3020 NEXT N
3030 FOR M=1 TO 8
3040 IF FREQ=F(M) THEN GOTO 3090
3050 NEXT M
3060 FOR M=1 TO 7
3070 IF F(M)<FREQ AND FREQ<F(M+1) THEN GOTO 3110
3080 NEXT M
3090 FOC=FF(M,N)+(FF(M,N+1)-FF(M,N))*(HOPL-D(N))/(D(N+1)-D(N))
3100 GOTO 3250
3110 FFM1=FF(M,N)+(FF(M,N+1)-FF(M,N))*(HOPL-D(N))/(D(N+1)-D(N))
3120 FFM2=FF(M+1,N)+(FF(M+1,N+1)-FF(M+1,N))*(HOPL-D(N))/(D(N+1)-D(N))
3130 FOC=FFM1+(FFM2-FFM1)*(FREQ-F(M))/(F(M+1)-F(M))
3140 GOTO 3250
3150 REM FREQINT
3160 FOR M=1 TO 8
3170 IF FREQ=F(M) THEN GOTO 3220
3180 NEXT M
3190 FOR M=1 TO 7
3200 IF F(M)<FREQ AND FREQ<F(M+1) THEN GOTO 3240
3210 NEXT M
3220 FOC=FF(M,N)
3230 GOTO 3250
3240 FOC=FF(M,N)+(FF(M+1,N)-FF(M,N))*(FREQ-F(M))/(F(M+1)-F(M))
3250 RETURN
3260 REM
3270 REM  antenna factor subroutine
3280 REM *INTAF
3290 FOR N=1 TO 13
3300 IF PSI=PS(N) THEN GOTO 3470
3310 NEXT N
3320 FOR N=1 TO 12
3330 IF PS(N)>PSI AND PSI>PS(N+1) THEN GOTO 3350
3340 NEXT N
3350 FOR M=1 TO 8
3360 IF FREQ=F(M) THEN GOTO 3410
3370 NEXT M
3380 FOR M=1 TO 7
3390 IF F(M)<FREQ AND FREQ<F(M+1) THEN GOTO 3430
3400 NEXT M
3410 ANT=AF(M,N)+(AF(M,N+1)-AF(M,N))*(PSI-PS(N))/(PS(N+1)-PS(N))
3420 GOTO 3570
3430 AFM1=AF(M,N)+(AF(M,N+1)-AF(M,N))*(PSI-PS(N))/(PS(N+1)-PS(N))
3440 AFM2=AF(M+1,N)+(AF(M+1,N+1)-AF(M+1,N))*(PSI-PS(N))/(PS(N+1)-PS(N))
3450 ANT=AFM1+(AFM2-AFM1)*(FREQ-F(M))/(F(M+1)-F(M))
3460 GOTO 3570
3470 REM freqint
3480 FOR M=1 TO 8
3490 IF FREQ=F(M) THEN GOTO 3540
3500 NEXT M
3510 FOR M=1 TO 7
3520 IF F(M)<FREQ AND FREQ<F(M+1) THEN GOTO 3560
3530 NEXT M
3540 ANT=AF(M,N)
3550 GOTO 3570
3560 ANT=AF(M,N)+(AF(M+1,N)-AF(M,N))*(FREQ-F(M))/(F(M+1)-F(M))
3570 RETURN
3580 REM
3590 REM  ionospheric reflection coefficient subroutine
3600 REM *INTRC
3610 FOR N=1 TO 15
3620 IF FC=FCS(N) THEN GOTO 3790
3630 NEXT N
3640 FOR N=1 TO 14
3650 IF FCS(N)<FC AND FC<FCS(N+1) THEN GOTO 3670
3660 NEXT N
3670 FOR M=1 TO 11
3680 IF COSK=CSX(M) THEN GOTO 3730
3690 NEXT M
3700 FOR M=1 TO 10
3710 IF CSX(M)<COSK AND COSK<=CSX(M+1) THEN GOTO 3750
3720 NEXT M
3730 RC=RCX(M,N)+(RCX(M,N+1)-RCX(M,N))*(FC-FCS(N))/(FCS(N+1)-FCS(N))
3740 GOTO 3900
3750 RCM1=RCX(M,N)+(RCX(M,N+1)-RCX(M,N))*(FC-FCS(N))/(FCS(N+1)-FCS(N))
3760 RCM2=RCX(M+1,N)+(RCX(M+1,N+1)-RCX(M+1,N))*(FC-FCS(N))/(FCS(N+1)-FCS(N))
3770 RC=RCM1+(RCM2-RCM1)*(COSK-CSX(M))/(CSX(M+1)-CSX(M))
3780 GOTO 3900
3790 FOR M=1 TO 11
3800 IF COSK=CSX(M) THEN GOTO 3850
3810 NEXT M
3820 FOR M=1 TO 10
3830 IF CSX(M)<COSK AND COSK<=CSX(M+1) THEN GOTO 3870
3840 NEXT M
3850 RC=RCX(M,N)
3860 GOTO 3900
3870 RC=RCX(M,N)+(RCX(M+1,N)-RCX(M,N))*(COSK-CSX(M))/(CSX(M+1)-CSX(M))
3880 GOTO 3900
3890 RC=RCX(M,N)
3900 RC=10^RC
3910 RETURN
3920 REM
3930 DATA 20,50,100,150,200,300,400,500
3940 DATA 50,200,400,800,1000,1200,1400,1500,1600,1700,1800,1900,2000,2500,3000,4000
3950 DATA 1,1.02,1.06,1.2,1.29,1.40,1.53,1.58,1.61,1.64,1.66,1.68,1.70,1.89,1.89,1.89
3960 DATA 1,1.02,1.06,1.2,1.30,1.46,1.62,1.70,1.78,1.84,1.89,1.94,1.99,2.22,2.22,2.22
3970 DATA 1,1.02,1.06,1.2,1.31,1.48,1.69,1.80,1.92,2.03,2.11,2.17,2.22,2.47,2.47,2.47
3980 DATA 1,1.02,1.06,1.2,1.32,1.50,1.73,1.85,1.99,2.12,2.22,2.30,2.37,2.64,2.64,2.64
3990 DATA 1,1.02,1.06,1.2,1.32,1.51,1.74,1.88,2.03,2.19,2.31,2.40,2.49,2.79,2.79,2.79
4000 DATA 1,1.02,1.06,1.2,1.32,1.52,1.76,1.90,2.07,2.25,2.40,2.50,2.60,2.89,2.89,2.89
4010 DATA 1,1.02,1.06,1.2,1.32,1.52,1.76,1.90,2.07,2.25,2.40,2.50,2.60,2.89,2.89,2.89
4020 DATA 1,1.02,1.06,1.2,1.32,1.52,1.76,1.90,2.07,2.25,2.40,2.50,2.60,2.89,2.89,2.89
4030 REM
4040 DATA 80,15,10,7.5,5,3.75,2.5,1.25,0,-1.25,-2.5,-5,-7.5
4050 DATA 1,1,1,0.98,0.95,0.91,0.87,0.8,0.70,0.60,0.50,0.33,0.22
4060 DATA 1,1,1,0.98,0.95,0.91,0.87,0.8,0.70,0.575,0.447,0.263,0.14
4070 DATA 1,1,1,0.98,0.95,0.91,0.87,0.8,0.68,0.55,0.4,0.19,0.085
4080 DATA 1,1,1,0.98,0.95,0.91,0.87,0.8,0.66,0.525,0.36,0.15,0.05
4090 DATA 1,1,1,0.98,0.95,0.91,0.87,0.8,0.65,0.5,0.324,0.12,0.043
4100 DATA 1,1,1,0.98,0.95,0.91,0.87,0.8,0.636,0.48,0.29,0.088,0.025
4110 DATA 1,1,1,0.98,0.95,0.91,0.87,0.8,0.626,0.46,0.26,0.07,0.02
4120 DATA 1,1,1,0.98,0.95,0.91,0.87,0.8,0.617,0.44,0.24,0.06,0.016
4130 REM
4140 DATA 0.95,0.95,0.92,0.90,0.83,0.8,0.75,0.68,0.6,0.525,0.44,0.3,0.2
4150 DATA 0.92,0.92,0.87,0.8,0.74,0.7,0.63,0.575,0.48,0.4,0.33,0.2,0.12
4160 DATA 0.81,0.81,0.79,0.75,0.68,0.616,0.52,0.457,0.35,0.26,0.18,0.076,0.027
4170 DATA 0.78,0.78,0.75,0.71,0.63,0.55,0.46,0.38,0.26,0.17,0.1,0.03,0.005
4180 DATA 0.76,0.76,0.71,0.67,0.58,0.5,0.41,0.324,0.21,0.13,0.063,0.013,0.0021
4190 DATA 0.7,0.7,0.65,0.64,0.55,0.47,0.37,0.26,0.16,0.08,0.034,0.0035,0.0004
4200 DATA 0.65,0.65,0.62,0.61,0.52,0.44,0.34,0.24,0.14,0.06,0.02,0.0016,0.0001
4210 DATA 0.6,0.6,0.6,0.58,0.5,0.417,0.33,0.23,0.13,0.05,0.013,0.0008,0.00004
4220 REM
4230 DATA 0.9,0.89,0.83,0.79,0.72,0.68,0.63,0.57,0.51,0.45,0.38,0.26,0.17
4240 DATA 0.8,0.79,0.73,0.67,0.6,0.54,0.47,0.4,0.33,0.25,0.18,0.09,0.041
4250 DATA 0.7,0.69,0.65,0.6,0.51,0.45,0.38,0.3,0.22,0.13,0.073,0.02,0.0045
4260 DATA 0.61,0.6,0.57,0.53,0.45,0.39,0.33,0.24,0.16,0.084,0.04,0.007,0.001
4270 DATA 0.53,0.52,0.5,0.46,0.40,0.35,0.28,0.20,0.12,0.06,0.025,0.0035,0.00041
4280 DATA 0.46,0.45,0.44,0.41,0.36,0.31,0.25,0.17,0.09,0.038,0.013,0.0013,0.00014010 DATA 0.4,0.39,0.38,0.37,0.33,0.28,0.22,0.15,0.07,0.026,0.008,0.00068,0.00005
4290 DATA 0.34,0.34,0.34,0.33,0.3,0.26,0.20,0.13,0.06,0.02,0.006,0.00043,0.00003
4300 REM
4310 DATA -1,-0.5,-0.35,-0.21,0,0.2,0.375,0.55,0.707,0.85,1
4320 DATA 5,8,10,15,20,30,40,50,75,100,150,200,300,400,500
4330 REM ssn min
4340 DATA -0.33,-0.34,-0.35,-0.36,-0.4,-0.47,-0.52,-0.56,-0.64,-0.7,-0.76,-0.76,-0.72,-0.66,-0.6
4350 DATA -0.33,-0.34,-0.35,-0.36,-0.4,-0.47,-0.52,-0.56,-0.64,-0.7,-0.76,-0.76,-0.72,-0.66,-0.6
4360 DATA -0.33,-0.34,-0.35,-0.39,-0.44,-0.53,-0.61,-0.67,-0.79,-0.85,-0.91,-0.91,-0.87,-0.81,-0.76
4370 DATA -0.33,-0.34,-0.36,-0.41,-0.48,-0.6,-0.72,-0.81,-0.95,-1.02,-1.07,-1.07,-1.03,-0.97,-0.92
4380 DATA -0.36,-0.37,-0.39,-0.48,-0.59,-0.76,-0.97,-1.07,-1.24,-1.36,-1.4,-1.42,-1.37,-1.35,-1.34
4390 DATA -0.39,-0.41,-0.44,-0.56,-0.72,-0.95,-1.18,-1.32,-1.53,-1.66,-1.74,-1.78,-1.82,-1.81,-1.8
4400 DATA -0.43,-0.45,-0.49,-0.63,-0.82,-1.1,-1.34,-1.51,-1.76,-1.92,-2.06,-2.14,-2.24,-2.3,-2.34
4410 DATA -0.47,-0.5,-0.54,-0.74,-0.92,-1.24,-1.48,-1.66,-1.95,-2.15,-2.34,-2.46,-2.57,-2.72,-2.83
4420 DATA -0.52,-0.54,-0.59,-0.83,-1.05,-1.4,-1.64,-1.8,-2.1,-2.3,-2.58,-2.75,-2.92,-3.03,-3.1
4430 DATA -0.6,-0.66,-0.74,-1.03,-1.4,-1.81,-2.02,-2.2,-2.54,-2.82,-3.1,-3.26,-3.24,-3.21,-3.18
4440 DATA -0.76,-0.8,-0.9,-1.46,-2,-2.9,-3.45,-3.7,-3.93,-3.99,-3.97,-3.87,-3.66,-3.41,-3.2
4450 REM ssn med
4460 DATA -0.3,-0.31,-0.32,-0.33,-0.37,-0.43,-0.47,-0.51,-0.58,-0.64,-0.71,-0.73,-0.76,-0.76,-0.75
4470 DATA -0.3,-0.31,-0.32,-0.33,-0.37,-0.43,-0.47,-0.51,-0.58,-0.64,-0.71,-0.73,-0.76,-0.76,-0.75
4480 DATA -0.3,-0.31,-0.32,-0.36,-0.41,-0.49,-0.56,-0.61,-0.71,-0.76,-0.84,-0.87,-0.89,-0.88,-0.88
4490 DATA -0.3,-0.31,-0.33,-0.38,-0.44,-0.55,-0.65,-0.73,-0.85,-0.92,-1,-1.04,-1.07,-1.06,-1.06
4500 DATA -0.33,-0.34,-0.36,-0.44,-0.52,-0.64,-0.81,-0.91,-1.1,-1.22,-1.33,-1.39,-1.45,-1.51,-1.58
4510 DATA -0.36,-0.38,-0.40,-0.5,-0.62,-0.79,-0.98,-1.15,-1.36,-1.5,-1.66,-1.76,-1.92,-2.03,-2.14
4520 DATA -0.40,-0.42,-0.44,-0.57,-0.7,-0.93,-1.13,-1.29,-1.57,-1.76,-1.98,-2.12,-2.34,-2.49,-2.64
4530 DATA -0.44,-0.47,-0.5,-0.67,-0.83,-1.1,-1.33,-1.5,-1.83,-2.06,-2.32,-2.49,-2.69,-2.85,-2.98
4540 DATA -0.49,-0.51,-0.56,-0.77,-0.99,-1.32,-1.57,-1.75,-2.1,-2.35,-2.66,-2.84,-3.01,-3.13,-3.2
4550 DATA -0.57,-0.62,-0.7,-0.97,-1.33,-1.81,-2.07,-2.3,-2.68,-2.94,-3.19,-3.31,-3.34,-3.35,-3.33
4560 DATA -0.72,-0.77,-0.86,-1.31,-1.9,-2.74,-3.23,-3.5,-3.85,-3.95,-3.98,-3.92,-3.76,-3.58,-3.42
4570 REM ssn max
4580 DATA -0.27,-0.27,-0.28,-0.3,-0.34,-0.38,-0.42,-0.46,-0.52,-0.57,-0.65,-0.7,-0.8,-0.85,-0.89
4590 DATA -0.27,-0.27,-0.28,-0.3,-0.34,-0.38,-0.42,-0.46,-0.52,-0.57,-0.65,-0.7,-0.8,-0.85,-0.89
4600 DATA -0.27,-0.27,-0.28,-0.32,-0.37,-0.44,-0.5,-0.55,-0.62,-0.67,-0.76,-0.82,-0.91,-0.95,-1.01
4610 DATA -0.27,-0.27,-0.29,-0.34,-0.4,-0.5,-0.58,-0.64,-0.74,-0.82,-0.93,-1,-1.1,-1.16,-1.2
4620 DATA -0.29,-0.30,-0.32,-0.39,-0.44,-0.52,-0.64,-0.74,-0.96,-1.08,-1.25,-1.36,-1.53,-1.67,-1.81
4630 DATA -0.32,-0.33,-0.36,-0.44,-0.5,-0.62,-0.78,-0.9,-1.18,-1.34,-1.57,-1.73,-2.02,-2.26,-2.48
4640 DATA -0.35,-0.36,-0.40,-0.5,-0.57,-0.76,-0.92,-1.06,-1.38,-1.6,-1.9,-2.1,-2.44,-2.68,-2.89
4650 DATA -0.39,-0.41,-0.45,-0.6,-0.73,-0.95,-1.17,-1.34,-1.69,-1.96,-2.29,-2.52,-2.8,-2.97,-3.13
4660 DATA -0.45,-0.48,-0.52,-0.7,-0.92,-1.24,-1.5,-1.7,-2.09,-2.4,-2.73,-2.92,-3.1,-3.22,-3.3
4670 DATA -0.54,-0.58,-0.65,-0.9,-1.25,-1.8,-2.11,-2.4,-2.81,-3.06,-3.28,-3.36,-3.43,-3.48,-3.48
4680 DATA -0.67,-0.74,-0.82,-1.15,-1.8,-2.58,-3,-3.3,-3.75,-3.9,-3.98,-3.97,-3.85,-3.74,-3.64
4690 REM
4700 REM Ground Wave field strength based on Rec. P.368
4710 REM *GWAVE
4720 RESTORE 5330
4730 FOR M=1 TO 10 :READ FG(M) :NEXT M
4740 FOR N=1 TO 19 :READ DG(N) :NEXT N
4750 IF GCT=1 THEN GOTO 4760 ELSE IF GCT=2 THEN GOTO 4830 ELSE GOTO 4900
4760 RESTORE 5360
4770 FOR M=1 TO 10
4780 FOR N=1 TO 19
4790 READ GW(M,N)
4800 NEXT N
4810 NEXT M
4820 GOTO 5000 REM *INTGW
4830 RESTORE 5470
4840 FOR M=1 TO 10
4850 FOR N=1 TO 19
4860 READ GW(M,N)
4870 NEXT N
4880 NEXT M
4890 GOTO 5000 REM *INTGW
4900 RESTORE 5580
4910 FOR M=1 TO 10
4920 FOR N=1 TO 19
4930 READ GW(M,N)
4940 NEXT N
4950 NEXT M
4960 GOTO 5000 REM *INTGW
4970 GWS=GWS+10*LOG(P)/LOG(10)
4980 RETURN
4990 REM
5000 REM *INTGW
5010 FOR N=1 TO 19
5020 IF GR=DG(N) THEN GOTO 5200
5030 NEXT N
5040 FOR N=1 TO 18
5050 IF DG(N)<GR AND GR<DG(N+1) THEN GOTO 5070
5060 NEXT N
5070 FOR M=1 TO 10
5080 IF FREQ=FG(M) THEN GOTO 5130
5090 NEXT M
5100 FOR M=1 TO 9
5110 IF FG(M)<FREQ AND FREQ<FG(M+1) THEN GOTO 5150
5120 NEXT M
5130 GWS=GW(M,N)+(GW(M,N+1)-GW(M,N))*(GR-DG(N))/(DG(N+1)-DG(N))
5140 GOTO 5300
5150 REM distance interpolation
5160 GWM1=GW(M,N)+(GW(M,N+1)-GW(M,N))*(GR-DG(N))/(DG(N+1)-DG(N))
5170 GWM2=GW(M+1,N)+(GW(M+1,N+1)-GW(M+1,N))*(GR-DG(N))/(DG(N+1)-DG(N))
5180 GWS=GWM1+(GWM2-GWM1)*(FREQ-FG(M))/(FG(M+1)-FG(M))
5190 GOTO 5300
5200 REM frequency interpolation
5210 FOR M=1 TO 10
5220 IF FREQ=FG(M) THEN GOTO 5270
5230 NEXT M
5240 FOR M=1 TO 9
5250 IF FG(M)<FREQ AND FREQ<FG(M+1) THEN GOTO 5290
5260 NEXT M
5270 GWS=GW(M,N)
5280 GOTO 5300
5290 GWS=GW(M,N)+(GW(M+1,N)-GW(M,N))*(FREQ-FG(M))/(FG(M+1)-FG(M))
5300 GOTO 4970
5310 REM
5320 REM ground wave field strength data
5330 DATA 20,40,50,75,100,150,200,300,400,500
5340 DATA 50,100,150,200,300,400,500,600,700,800,900,1000,1200,1400,1600,1800,2000,3000,4000
5350 REM
5360 DATA 75,69,65.2,62.7,58.7,55.9,53,51,49,47.5,46,44,41,37.5,34,31,27.5,13,-1
5370 DATA 75,68.8,65,62.5,58.4,55.5,52.5,50.1,48.2,45.8,43.9,42,38,34,30.2,26.3,22.5,5,-11.5
5380 DATA 75,68.7,64.9,62.2,58.1,55,51.7,49.1,47.1,44.8,42.9,41,36.5,32.5,28.5,24.5,20.4,1.5,-16
5390 DATA 75,68.6,64.7,62,57.8,54.4,50.9,48.1,46.0,43.8,41.9,39,35,30.5,26.2,22,17.5,-3,-23
5400 DATA 75,68.5,64.6,61.8,57.5,53.8,50.1,47.1,44.7,42.5,40.4,37.5,33,28.5,24,19,14.5,-8,-29
5410 DATA 75,68.4,64.4,61.6,57.2,53.2,49.3,46.1,43.5,41.3,38.9,36,31,26,20.5,15.4,10,-14.5,-36
5420 DATA 75,68.3,64.3,61.4,56.9,52.6,48.6,45.1,42.3,39.8,37.2,34,28.5,23,17.5,12,6,-20,-42.5
5430 DATA 75,68.2,64.1,61.2,56.6,52,47.9,44.1,41.1,38.3,35.4,32,26.2,20,13.7,7.5,1,-27.5,-52
5440 DATA 75,68.1,63.9,61,56.3,51.5,47.2,43.1,39.9,36.8,33.6,30,23,16.5,9.6,3,-4,-35,-62
5450 DATA 75,68,63.8,60.8,56,51,46.5,42.1,38.7,35.3,31.9,27.5,20.3,13.3,6.5,-0.5,-7.5,-42,-70
5460 REM
5470 DATA 75,69,65.1,62.5,59,55.5,53,50.5,49,47,45.2,43.5,40.5,37,34,31,28,14,0
5480 DATA 74.8,68.6,64.9,62.2,58,55,52,49.5,47.4,45.5,43.2,41.3,37.5,33.5,30,26.5,22.5,5,-12
5490 DATA 74.7,68.4,64.7,62,57.4,54,51.2,48.5,46,44,42,40,36,31.6,28,24,20,1,-17
5500 DATA 74.6,68.2,64.4,61.5,56.7,53,49.7,47,44,41.6,39.5,37,32,27.2,22.5,17.7,13,-9,-30
5510 DATA 74.5,68,63.8,60.5,55,51,48,45,42,38.8,36,33,27.5,22,17,11.5,6,-20,-42
5520 DATA 74,67.2,62.6,59,52,47.3,43,39,35,31.5,27.5,24,17,10,3,-4,-11,-43,-67
5530 DATA 73.3,65.5,60.4,56,48,42.5,37.5,32.5,27.5,23,18.6,14,5,-3.5,-12.5,-21,-30,-65,-90
5540 DATA 71.5,61.7,54.4,49,40,32.5,26,19,13,7.5,1.5,-4,-15.5,-27.5,-37.5,-47,-55,-90,-120
5550 DATA 68,57.2,48.8,42.5,32.5,24.2,17,10,2.5,-4.3,-11,-17.5,-30,-42.5,-53,-62,-71,-110,-145
5560 DATA 65,52.5,43.3,37,27,17.7,10,2,-5.5,-13,-20,-28,-41,-53,-65,-75,-85,-125,-165
5570 REM
5580 DATA 74.5,68.5,64.7,62,57.5,54.5,51.5,49,47,45,43,41.2,37.7,34.3,31,27.7,24.5,9,-5.5
5590 DATA 74,67.5,63.1,60,55,51,47,43.5,40.5,37,34.5,31.7,26.5,21.2,16.5,12,7,-17,-39
5600 DATA 73.5,66,60.8,57.5,52.5,47.5,43.5,40,36.5,33.2,30,26.5,20,14,8,2.2,-3.5,-30,-57
5610 DATA 72.5,63,57.3,53,46,40,34.5,30,25,20.5,16.5,12,4.5,-3.5,-11,-18,-25,-57,-87
5620 DATA 71,59.5,52.3,47.5,40,32.5,26,21,16,11,6.3,1.5,-8,-16.5,-25.5,-34,-42.5,-79.5,-115
5630 DATA 66,53.5,44,38,29.5,22,15.5,9.5,4,-2,-7.5,-13,-24,-35,-46,-55,-65,-108,-152
5640 DATA 61,47.3,38.5,32.5,23,14.5,8,1,-6,-12,-18.5,-25,-38,-50,-62.5,-73,-83.5,-134,-185
5650 DATA 52.5,39,31,25,15,6.5,-1.5,-9.5,-17,-24,-32.5,-40,-54.5,-69,-80,-92,-102,-158,-214
5660 DATA 47,34,26.2,20,9,-1,-9,-18.5,-27.5,-36,-44,-53,-68.5,-82,-95,-106,-118,-177,-236
5670 DATA 43,30,20.9,14.2,3,-8,-18,-28,-37,-45,-54,-63,-80,-95,-109,-122,-135,-200,-264
 
